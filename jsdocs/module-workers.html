<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Module: workers</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Module: workers</h1>

    




<section>

<header>
    
        
            
        
    
</header>

<article>
    <div class="container-overview">
    
        
            <div class="description"><p>This module provides functionality for Web Workers to listen for
background script events generated by WebScience. The design pattern
is simple: for each event you want your worker script to observe, use
<code>createEventListener</code> to generate a listener, then add the listener
to the event. The function will automatically convert background
script events to messages posted to your worker script.</p>
<h2>Design Considerations</h2>
<p>We use message passing for WebScience integration with Web Workers,
because of Content Security Policy considerations. Specifically, if
we were to replicate WebScience APIs inside of worker scripts, we
would need to load inlined worker scripts from the background page.
There is, however, no way to permit only specific inline worker
scripts in Content Security Policy Level 3. We would have to allow
all blob URLs to load as worker scripts, which may not be permissible
for addons.mozilla.org review.</p>
<h2>Future Directions</h2>
<p>If we identify a path forward for loading worker scripts from blob
URLs, we could enable a more streamlined design pattern for WebScience
event listeners in worker scripts.</p></div>
        

        
            















<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="workers.js.html">workers.js</a>, <a href="workers.js.html#line1">line 1</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id=".createEventListener"><span class="type-signature">(static) </span>createEventListener<span class="signature">(worker, eventName<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {function}</span></h4>
    

    



<div class="description">
    <p>Create a listener for a WebScience event that will automatically
send a message to a Worker when the event occurs.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>worker</code></td>
            

            <td class="type">
            
                
<span class="param-type">Worker</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>The Worker that should receive messages
about the event.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>eventName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>The name of the event, which is used
as the <code>eventName</code> property in messages to the Worker. This parameter
is not necessary when adding the listener to a WebScience event or
an event created with <code>events.createEvent</code> (if an an event name is
specified), because <code>eventName</code> (if not provided as a parameter) will
be automatically set to the event's name when the listener is added to
the event.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="workers.js.html">workers.js</a>, <a href="workers.js.html#line93">line 93</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>A listener for the event. Each listener should
only be used with one event.</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">function</span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>// An example of how to use `workers.createEventListener` for
// natural language processing in a Web Worker.

// background.js
const worker = new Worker("worker.js");
webScience.pageText.onTextParsed.addListener(
  webScience.workers.createEventListener(worker),
  {
    matchPatterns: [ "*://*.example.com/*" ]
  });

// worker.js
function onTextParsedListener(textParsedDetails) {
  // Natural language processing on webpage text
}
self.addEventListener("message", event => {
  if((typeof event.data === "object") &amp;&amp;
     ("eventName" in event.data) &amp;&amp;
     (event.data.eventName === "webScience.pageText.onTextParsed")) {
    onTextParsedListener.apply(null, event.data.listenerArguments);
  }
});</code></pre>



        
    

    
        <h3 class="subsection-title">Type Definitions</h3>

        
                
<h4 class="name" id="~WorkerEventData">WorkerEventData</h4>




<div class="description">
    <p>An object that is posted as a message to a Web Worker when an
event fires.</p>
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Object</span>


        </li>
    </ul>





    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>eventName</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>The name of the event.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>listenerArguments</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"><p>The arguments that would be
passed to an event listener in the background script.</p></td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="workers.js.html">workers.js</a>, <a href="workers.js.html#line27">line 27</a>
    </li></ul></dd>
    

    

    

    
</dl>





    <h5>Examples</h5>
    
    <pre class="prettyprint"><code>// {
//   eventName: "webScience.scheduling.onIdleDaily",
//   listenerArguments: [ ]
// }</code></pre>

    <pre class="prettyprint"><code>// {
//   eventName: "webScience.idle.onStateChanged",
//   listenerArguments: [ "idle" ]
// }</code></pre>

    <pre class="prettyprint"><code>// {
//   eventName: "webScience.pageNavigation.onPageData",
//   listenerArguments: [{
//     pageId: "e60f1f92-f42b-4084-93a7-9e7145e5f716",
//     url: "https://www.example.com/",
//     ...
//   }]
// }</code></pre>



            
    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-debugging.html">debugging</a></li><li><a href="module-events.html">events</a></li><li><a href="module-id.html">id</a></li><li><a href="module-idle.html">idle</a></li><li><a href="module-inline.html">inline</a></li><li><a href="module-linkExposure.html">linkExposure</a></li><li><a href="module-linkResolution.html">linkResolution</a></li><li><a href="module-matching.html">matching</a></li><li><a href="module-messaging.html">messaging</a></li><li><a href="module-pageManager.html">pageManager</a></li><li><a href="module-pageNavigation.html">pageNavigation</a></li><li><a href="module-pageText.html">pageText</a></li><li><a href="module-pageTransition.html">pageTransition</a></li><li><a href="module-permissions.html">permissions</a></li><li><a href="module-randomization.html">randomization</a></li><li><a href="module-scheduling.html">scheduling</a></li><li><a href="module-socialMediaActivity.html">socialMediaActivity</a></li><li><a href="module-socialMediaLinkSharing.html">socialMediaLinkSharing</a></li><li><a href="module-storage.html">storage</a></li><li><a href="module-timing.html">timing</a></li><li><a href="module-userSurvey.html">userSurvey</a></li><li><a href="module-workers.html">workers</a></li></ul><h3>Namespaces</h3><ul><li><a href="module-idle.onStateChanged.html">onStateChanged</a></li><li><a href="module-linkExposure.onLinkExposureData.html">onLinkExposureData</a></li><li><a href="module-linkExposure.onLinkExposureUpdate.html">onLinkExposureUpdate</a></li><li><a href="module-messaging.onMessage.html">onMessage</a></li><li><a href="module-pageManager.onPageVisitStart.html">onPageVisitStart</a></li><li><a href="module-pageManager.onPageVisitStop.html">onPageVisitStop</a></li><li><a href="module-pageNavigation.onPageData.html">onPageData</a></li><li><a href="module-pageText.onTextParsed.html">onTextParsed</a></li><li><a href="module-pageTransition.onPageTransitionData.html">onPageTransitionData</a></li><li><a href="module-scheduling.onIdleDaily.html">onIdleDaily</a></li><li><a href="module-scheduling.onIdleWeekly.html">onIdleWeekly</a></li></ul><h3>Classes</h3><ul><li><a href="module-events-Event.html">Event</a></li><li><a href="module-matching-MatchPatternSet.html">MatchPatternSet</a></li><li><a href="module-storage-Counter.html">Counter</a></li><li><a href="module-storage-KeyValueStorage.html">KeyValueStorage</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Thu Aug 04 2022 00:27:13 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>